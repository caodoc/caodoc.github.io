<h2> Nhập số báo danh: </h2>

</br>

<div id="tcdt-container">
    <textarea id="tcdt-sbd" placeholder="Nhập số báo danh tại đây" autofocus></textarea>
    <button id="tcdt-submit"> Tra cứu </button>
</div>

<div id="tcdt-error-display"></div>

<h2> Thông tin số báo danh đã tra cứu: </h2>

<div id="tcdt-result"></div>

<style>
    #tcdt-container
    {
        display: flex;
        gap: 10px;
    }

    #tcdt-result
    {
        display: flex;
        gap: 20px;
    }

    #tcdt-sbd
    {
        width: 200px;
        padding: 7.5px 0px 0px 7.5px;
        background-color: transparent;
        border-radius: 5px;
        color: var(--fg);
    }

    #tcdt-sbd::placeholder
    {
        color: var(--fg);
    }

    #tcdt-submit
    {
        max-width: max-content;
        padding: 0px 10px 0px 10px;
        display: inline-block;
        background-color: var(--muted);
        border: none;
        border-radius: 5px;
        color: var(--fg);
    }

    #tcdt-submit:hover
    {
        cursor: pointer;
    }

    #tcdt-result
    {
        display: flex;
        flex-direction: column;
    }

    text
    {
        display: inline-block;
    }
</style>
    
<script>
    document.getElementById("tcdt-submit").addEventListener("click", () => {
        var tcdt_space = "&nbsp;&nbsp;&nbsp;";
        let tcdt_sbd = document.getElementById("tcdt-sbd").value.replace(/ /g,"");
        console.log(tcdt_sbd);
        if (tcdt_sbd === "") document.getElementById("tcdt-error-display").innerText = "Bạn chưa nhập số báo danh!";
        else
        {
            fetch(`https://caodoc-api.exozy.me/thpt?sbd=${tcdt_sbd}`)
                .then(response => {
                    if (response.status === 200) return response.json();
                    else if (response.status === 404)
                    {
                        document.getElementById("tcdt-error-display").innerText = `Không tìm thấy thí sinh nào có số báo danh ${tcdt_sbd}.`;
                        throw new Error(`Không tìm thấy thí sinh nào có số báo danh ${tcdt_sbd}.`);
                    }
                    else
                    {
                        document.getElementById("tcdt-error-display").innerText = "Đã xãy ra lỗi, mình sẽ sửa lỗi nhanh nhất có thể!";
                        throw new Error("Đã xãy ra lỗi, mình sẽ sửa lỗi nhanh nhất có thể!");
                    }
                })
                .then(data => {
                    console.log(data);
                    let ketqua = `SBD: ${data.sbd} </br>`;
                    if (data.toan != "") ketqua += `<text> Toán: ${data.toan}${tcdt_space} </text>`;
                    if (data.ngu_van != "") ketqua += `<text> Ngữ văn: ${data.ngu_van}${tcdt_space} </text>`;
                    if (data.ngoai_ngu != "") ketqua += `<text> Ngoại ngữ: ${data.ngoai_ngu}${tcdt_space} </text>`;
                    if (data.vat_li != "") ketqua += `<text> Vật lí: ${data.vat_li}${tcdt_space} </text>`;
                    if (data.hoa_hoc != "") ketqua += `<text> Hóa học: ${data.hoa_hoc}${tcdt_space} </text>`;
                    if (data.sinh_hoc != "") ketqua += `<text> Sinh học: ${data.sinh_hoc}${tcdt_space} </text>`;
                    if (data.lich_su != "") ketqua += `<text> Lịch sử: ${data.lich_su}${tcdt_space} </text>`;
                    if (data.dia_li != "") ketqua += `<text> Địa lí: ${data.dia_li}${tcdt_space} </text>`;
                    if (data.gdcd != "") ketqua += `<text> GDCD: ${data.gdcd}${tcdt_space} </text>`;
                    if (data.ma_ngoai_ngu != "") ketqua += `<text> Mã ngoại ngữ: ${data.ma_ngoai_ngu} </text>`;
                    document.getElementById("tcdt-result").innerHTML += `<text> ${ketqua} </text> <hr>`;
                    document.getElementById("tcdt-error-display").innerText = "";
                })
                .catch(error => {
                    console.error(error.message);
                });
        }
    });
</script>